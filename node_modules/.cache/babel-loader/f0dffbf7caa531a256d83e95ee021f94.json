{"ast":null,"code":"const MapboxDraw = require('@mapbox/mapbox-gl-draw');\nconst Constants = require(\"../../lib/utils/constants\");\nconst doubleClickZoom = require(\"../../lib/utils/double_click_zoom\");\nconst circle = require('@turf/circle').default;\nconst CircleMode = {\n  ...MapboxDraw.modes.draw_polygon\n};\nconst DEFAULT_RADIUS_IN_KM = 2;\nCircleMode.onSetup = function (opts) {\n  const polygon = this.newFeature({\n    type: Constants.geojsonTypes.FEATURE,\n    properties: {\n      isCircle: true,\n      center: []\n    },\n    geometry: {\n      type: Constants.geojsonTypes.POLYGON,\n      coordinates: [[]]\n    }\n  });\n  this.addFeature(polygon);\n  this.clearSelectedFeatures();\n  doubleClickZoom.disable(this);\n  this.updateUIClasses({\n    mouse: Constants.cursors.ADD\n  });\n  this.activateUIButton(Constants.types.POLYGON);\n  this.setActionableState({\n    trash: true\n  });\n  return {\n    initialRadiusInKm: opts.initialRadiusInKm || DEFAULT_RADIUS_IN_KM,\n    polygon,\n    currentVertexPosition: 0\n  };\n};\nCircleMode.clickAnywhere = function (state, e) {\n  if (state.currentVertexPosition === 0) {\n    state.currentVertexPosition++;\n    const center = [e.lngLat.lng, e.lngLat.lat];\n    const circleFeature = circle(center, state.initialRadiusInKm);\n    state.polygon.incomingCoords(circleFeature.geometry.coordinates);\n    state.polygon.properties.center = center;\n    state.polygon.properties.radiusInKm = state.initialRadiusInKm;\n  }\n  return this.changeMode(Constants.modes.SIMPLE_SELECT, {\n    featureIds: [state.polygon.id]\n  });\n};\nmodule.exports = CircleMode;","map":null,"metadata":{},"sourceType":"script"}
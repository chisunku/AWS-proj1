{"ast":null,"code":"import _classCallCheck from\"/home/ec2-user/frontend-dropbox-proj1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/ec2-user/frontend-dropbox-proj1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/home/ec2-user/frontend-dropbox-proj1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/home/ec2-user/frontend-dropbox-proj1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/ec2-user/frontend-dropbox-proj1/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{PureComponent}from'react';import{saveAs}from\"file-saver\";import{dataService}from'../services/dataService';import UploadFile from'./UploadFile';import LogOut from'./LogOut';import LogInPage from'./LogIn';import'../myStyle.css';var jwt=require('jsonwebtoken');var HomePage=/*#__PURE__*/function(_PureComponent){_inherits(HomePage,_PureComponent);var _super=_createSuper(HomePage);function HomePage(props){var _this;_classCallCheck(this,HomePage);_this=_super.call(this,props);var sessionToken=sessionStorage.getItem(\"token\");_this.state={admin:false,disp_user:[],user_data:undefined,description:\"\"};_this.set_description=_this.set_description.bind(_assertThisInitialized(_this));_this.user_table=_this.user_table.bind(_assertThisInitialized(_this));return _this;}_createClass(HomePage,[{key:\"set_description\",value:function set_description(d){this.setState({description:d});}},{key:\"admin_table\",value:function admin_table(user,user_admin){var _this2=this;var boll=false;if(user_admin==true)boll=true;dataService.get_user_data(user,boll).then(function(json){console.log(json);if(Array.isArray(json)){_this2.setState({disp_user:json});}}).catch(function(e){console.log(e);});}},{key:\"user_table\",value:function user_table(user){var _this3=this;dataService.get_user_data(user,true).then(function(json){console.log(json);if(Array.isArray(json)){_this3.setState({disp_user:json});}}).catch(function(e){console.log(e);});}},{key:\"componentDidMount\",value:function componentDidMount(){var _this4=this;var t=sessionStorage.getItem(\"token\");console.log(\"token: \",t);//console.log(this.state.user_data);\n//try {\n// const payload = this.verifier.verify(t);\n//} catch {\n// console.log(\"Invalid token\");\n//}\nvar decoded=jwt.decode(t);var decoded=jwt.decode(t,{complete:true});var userObj=decoded.payload;console.log(userObj);this.setState({user_data:userObj});console.log(this.state.user_data);setTimeout(function(){if(_this4.state.user_data.email==\"2712aabbccdd@gmail.com\"){_this4.state.admin=true;}if(_this4.state.admin){_this4.user_table(_this4.state.user_data.email,_this4.state.admin);}else{_this4.admin_table(_this4.state.user_data.email,_this4.state.admin);}},250);dataService.get_user();}},{key:\"onClickDownLoad\",value:function onClickDownLoad(file){window.open(\"https://dfbiaa0nywvvp.cloudfront.net/\"+file);saveAs(\"https://dfbiaa0nywvvp.cloudfront.net/\"+file,file);}},{key:\"onClickDelete\",value:function onClickDelete(fileName,id){var _this5=this;dataService.delete_file(fileName,id).then(function(json){console.log(json);setTimeout(function(){if(_this5.state.admin){_this5.user_table();}else{_this5.admin_table(_this5.state.user_data.email);}},250);}).catch(function(e){console.log(e);});}},{key:\"render\",value:function render(){var _this6=this;var admin=this.state.admin;return/*#__PURE__*/React.createElement(\"center\",null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",null,\" User: \",this.state.user_data&&/*#__PURE__*/React.createElement(\"a\",{href:\"#login\"},this.state.user_data.email),\"\\xA0\\xA0 User Type:  \",admin&&/*#__PURE__*/React.createElement(\"a\",null,\" \\\"ADMIN\\\" \"),!admin&&/*#__PURE__*/React.createElement(\"a\",null,\" \\\"Non Admin\\\"\"),this.state.user_data&&/*#__PURE__*/React.createElement(LogOut,{class:\"topright\"}),!this.state.user_data&&/*#__PURE__*/React.createElement(LogInPage,null)),this.state.user_data&&/*#__PURE__*/React.createElement(UploadFile,{user:this.state.user_data.email,description:this.state.description,refreshList:function refreshList(e){return _this6.user_table();},refreshList2:function refreshList2(e){return _this6.admin_table(e);},admin:admin}),\"\\xA0 \\xA0\",/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"table\",null,/*#__PURE__*/React.createElement(\"tr\",{key:0},admin&&/*#__PURE__*/React.createElement(\"th\",null,\"User\"),/*#__PURE__*/React.createElement(\"th\",null,\"File Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Description\"),/*#__PURE__*/React.createElement(\"th\",null,\"File Upload Time\"),/*#__PURE__*/React.createElement(\"th\",null,\"File Updated Time\"),!admin&&/*#__PURE__*/React.createElement(\"th\",null,\"Download\"),/*#__PURE__*/React.createElement(\"th\",null,\"Delete\")),this.state.disp_user.map(function(ele){return/*#__PURE__*/React.createElement(\"tr\",{key:ele.id},admin&&/*#__PURE__*/React.createElement(\"td\",null,ele.userName),/*#__PURE__*/React.createElement(\"td\",null,ele.fileName),/*#__PURE__*/React.createElement(\"td\",null,ele.description),/*#__PURE__*/React.createElement(\"td\",null,ele.fileCreatedTime),/*#__PURE__*/React.createElement(\"td\",null,ele.fileUpdatedTime),!admin&&/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"a\",{href:\"https://dfbiaa0nywvvp.cloudfront.net/\"+ele.fileName,target:\"_blank\",download:ele.fileName},/*#__PURE__*/React.createElement(\"button\",{class:\"download_button\",onClick:function onClick(event){return _this6.onClickDownLoad(ele.fileName);}},\"DownLoad\"))),/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(\"button\",{class:\"delete_button\",onClick:function onClick(event){return _this6.onClickDelete(ele.fileName,ele.id);}},\"Delete\")));})))));}}]);return HomePage;}(PureComponent);export default HomePage;","map":{"version":3,"names":["React","PureComponent","saveAs","dataService","UploadFile","LogOut","LogInPage","jwt","require","HomePage","props","sessionToken","sessionStorage","getItem","state","admin","disp_user","user_data","undefined","description","set_description","bind","user_table","d","setState","user","user_admin","boll","get_user_data","then","json","console","log","Array","isArray","catch","e","t","decoded","decode","complete","userObj","payload","setTimeout","email","admin_table","get_user","file","window","open","fileName","id","delete_file","map","ele","userName","fileCreatedTime","fileUpdatedTime","event","onClickDownLoad","onClickDelete"],"sources":["/home/ec2-user/frontend-dropbox-proj1/src/components/HomePage.jsx"],"sourcesContent":["import React, { PureComponent } from 'react';\nimport { saveAs } from \"file-saver\";\nimport { dataService } from '../services/dataService';\nimport UploadFile from './UploadFile';\nimport LogOut from './LogOut';\nimport LogInPage from './LogIn';\nimport '../myStyle.css';\nvar jwt = require('jsonwebtoken');\n\nclass HomePage extends PureComponent {\n\n\n    constructor(props) {\n        super(props)\n        const sessionToken = sessionStorage.getItem(\"token\")\n        this.state = {\n            admin: false,\n            disp_user: [],\n            user_data: undefined,\n            description: \"\"\n        }\n        this.set_description = this.set_description.bind(this)\n        this.user_table = this.user_table.bind(this)\n    }\n    set_description(d) {\n        this.setState({\n            description: d\n        })\n    }\n    admin_table(user,user_admin) {\n        var boll = false;\n        if(user_admin == true)\n            boll = true;\n            dataService.get_user_data(user,boll)\n            .then(json => {\n                console.log(json);\n                if (Array.isArray(json)) {\n                    this.setState({\n                        disp_user: json\n                    });\n                }\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    }\n    user_table(user) {\n        dataService.get_user_data(user,true)\n            .then(json => {\n                console.log(json);\n                if (Array.isArray(json)) {\n                    this.setState({\n                        disp_user: json\n                    });\n                }\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    }\n    componentDidMount() {\n        var t = sessionStorage.getItem(\"token\");\n\tconsole.log(\"token: \",t);\n        //console.log(this.state.user_data);\n\t//try {\n         // const payload = this.verifier.verify(t);\n        //} catch {\n         // console.log(\"Invalid token\");\n        //}\n        var decoded = jwt.decode(t);\n        var decoded = jwt.decode(t, { complete: true });\n\tconst userObj = decoded.payload;\n\tconsole.log(userObj);\n        this.setState({\n            user_data: userObj\n        })\n\t    console.log(this.state.user_data);\n        setTimeout(()=> {\n            if(this.state.user_data.email==\"2712aabbccdd@gmail.com\"){\n                this.state.admin = true;\n            }\n            if (this.state.admin){\n                this.user_table(this.state.user_data.email,this.state.admin)\n            } else {\n                this.admin_table(this.state.user_data.email,this.state.admin);\n            }\n        }, 250);\n        dataService.get_user()\n    }\n\n    onClickDownLoad(file) {\n        window.open(\"https://dfbiaa0nywvvp.cloudfront.net/\" + file);\n        saveAs(\"https://dfbiaa0nywvvp.cloudfront.net/\"+file, file );\n    }\n\n    onClickDelete(fileName, id) {\n        dataService.delete_file(fileName, id)\n            .then(json => {\n                console.log(json);\n                setTimeout(()=> {\n                if (this.state.admin){\n                    this.user_table()\n                } else {\n                    this.admin_table(this.state.user_data.email);\n                }\n            }, 250);\n\n            })\n            .catch(e => {\n                console.log(e);\n            });\n    }\n\n    render() {\n        const { admin } = this.state;\n        return (\n            <center>\n                <div>\n                    <p> User: { this.state.user_data && <a href=\"#login\">{this.state.user_data.email}</a> }\n                    &nbsp;&nbsp;\n                    User Type:  { admin && <a> \"ADMIN\" </a> }\n                                { !admin && <a> \"Non Admin\"</a> }\n                    {this.state.user_data && <LogOut class='topright'></LogOut>}\n                    {!this.state.user_data && <LogInPage></LogInPage>}</p>\n                    { this.state.user_data &&\n                        <UploadFile\n                            user={this.state.user_data.email}\n                            description={this.state.description}\n                            refreshList={e => this.user_table()}\n                            refreshList2={e => this.admin_table(e)}\n                            admin={admin} >\n                        </UploadFile>\n                    }\n                    &nbsp; &nbsp;\n                    <div>\n                        <table>\n                            <tr key={0}>\n                                { admin && <th>User</th> }\n                                <th>File Name</th>\n                                <th>Description</th>\n                                <th>File Upload Time</th>\n                                <th>File Updated Time</th>\n                                {!admin && <th>Download</th>}\n                                <th>Delete</th>\n                            </tr>\n                            { this.state.disp_user.map(ele => {\n                                return (\n                                    <tr key={ele.id}>\n                                        { admin && <td>{ele.userName}</td> }\n                                        <td>{ele.fileName}</td>\n                                        <td>{ele.description}</td>\n                                        <td>{ele.fileCreatedTime}</td>\n                                        <td>{ele.fileUpdatedTime}</td>\n                                        { !admin &&\n                                            <td><a href={\"https://dfbiaa0nywvvp.cloudfront.net/\" + ele.fileName} target=\"_blank\" download={ele.fileName}>\n                                                <button class=\"download_button\" onClick={event => this.onClickDownLoad(ele.fileName)}>\n                                                    DownLoad\n                                                </button>\n                                            </a></td>\n                                        }\n                                        <td><button class=\"delete_button\" onClick={event => this.onClickDelete(ele.fileName, ele.id)}>\n                                            Delete\n                                        </button></td>\n                                    </tr>\n                                );})\n                            }\n                        </table>\n                    </div>\n                </div>\n            </center>\n        )\n    }\n}\n\nexport default HomePage\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}